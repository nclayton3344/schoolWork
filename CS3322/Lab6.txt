      ******************************************************************
      * A SIMPLE COBOL PROGRAM TO READ JCL IN-STREAM DATA
      * FROM A06IN DATASET
      * WRITE OUTPUT TO JCL OUTSTREAM
      * USING THE DISPLAY COMMAND
      * SOURCE CODE: CS332205.COBOL(ASSIGN06)
      * JCL: C332205.JCL(ASSIGN06)
      ******************************************************************
       IDENTIFICATION DIVISION.
       PROGRAM-ID. ASSIGN06.
       AUTHOR. NATHAN CLAYTON.
       INSTALLATION. WTAMU.
       DATE-WRITTEN. 11/04/2018.
       DATE-COMPILED.
       SECURITY. CONFIDENTIAL.
      *
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. BUFFALO-THUNDER.
       OBJECT-COMPUTER. BUFFALO-THUNDER.
       INPUT-OUTPUT SECTION.
      *FILE-CONTROL DEFINES OUR INPUT/OUTPUT FILES IN THE PROGRAM
       FILE-CONTROL.
           SELECT SALES-TRANS-MASTER ASSIGN TO AS06IN
               ORGANIZATION IS SEQUENTIAL.
           SELECT SALES-REPORT ASSIGN TO AS06OUT
               ORGANIZATION IS SEQUENTIAL.
      *
       DATA DIVISION.
      *FILE SECTION AND FD DEFINES THE RECORDS FOR OUR INPUT/OUTPUT
       FILE SECTION.
       FD SALES-TRANS-MASTER
           RECORDING MODE IS F
           RECORD CONTAINS 80 CHARACTERS.
       01 SALES-TRANS-IN.
           05 DAY-NO-IN             PIC 9.
           05 SALESPERSON-ID-IN     PIC 999.
           05 SALES-AMOUNT-IN       PIC 999V99.
       FD SALES-REPORT
           RECORDING MODE IS F
           RECORD CONTAINS 96 CHARACTERS.
       01 SALES-REPORT-OUT     PIC X(96).
      *WORKING STORAGE DEFINES DATA NEEDED FOR THE PROGRAM
       WORKING-STORAGE SECTION.

       01 ARE-THERE-MORE-RECORDS PIC X(3) VALUE "YES".
       01 MONDAY-TOTAL        PIC 99999V99.
       01 TUESDAY-TOTAL       PIC 99999V99.
       01 WEDNESDAY-TOTAL     PIC 99999V99.
       01 THURSDAY-TOTAL      PIC 99999V99.
       01 FRIDAY-TOTAL        PIC 99999V99.
       01 WEEKLY-TOTAL        PIC 999999V99.
       01 PAGE-COUNT          PIC 99 VALUE 1.

       01 WS-DATE.
           05 WS-YR         PIC 9999.
           05 WS-MONTH      PIC 99.
           05 WS-DAY        PIC 99.

       01 HEADER-LINE1.
           05 FILLER          PIC X(40) VALUE SPACES.
           05 TITLE-HEAD      PIC X(30)
                VALUE "S A L E S    R E P O R T".
           05 PAGE-HEAD       PIC X(8) VALUE "P A G E ".
           05 PAGE-NUM        PIC Z9.
           05 FILLER          PIC X(6) VALUE SPACES.
           05 DATE-OUT.
                10 HEAD-MONTH PIC XX.
                10 FILLER     PIC X VALUE "/".
                10 HEAD-DAY   PIC XX.
                10 FILLER     PIC X VALUE "/".
                10 HEAD-YEAR  PIC XXXX.

       01 HEADER-LINE2.
           05                  PIC X(24) VALUE SPACES.
           05                  PIC X(26) VALUE "D A Y".
           05                  PIC X(48) VALUE "T O T A L    S A L E S".

       01 FOOTER-LINE1.
           05 FILLER           PIC X(40) VALUE SPACES.
           05 TOT-WK-SALES     PIC X(40)
                VALUE "T O T A L   W E E K L Y    S A L E S".
           05 FILLER           PIC X VALUE "$".
           05 TOTAL-WEEKLY     PIC ZZZZZZ.99.
           05 FILLER           PIC X(7) VALUE "   *   ".

       01 DAILY-SALES-OUT.
           05 FILLER           PIC X(25) VALUE SPACES.
           05 WEEK-DAY-OUT     PIC XXX.
           05 FILLER           PIC X(23) VALUE SPACES.
           05 FILLER           PIC X VALUE "$".
           05 DAY-TOTAL-OUT    PIC ZZZZZZ.99.
           05 FILLER           PIC X(37) VALUE SPACES.

      *
       PROCEDURE DIVISION.
       100-MAIN-MODULE.
           PERFORM 500-GET-DATE-DATA
           OPEN INPUT SALES-TRANS-MASTER
           OPEN OUTPUT SALES-REPORT
           MOVE 1 TO PAGE-COUNT
           PERFORM 300-PRINT-HEADER
           PERFORM UNTIL ARE-THERE-MORE-RECORDS = "NO "
                READ SALES-TRANS-MASTER
                  AT END
                      MOVE 'NO ' TO ARE-THERE-MORE-RECORDS
                  NOT AT END
                        PERFORM 200-PROCESS-DATA
                END-READ
           END-PERFORM
           PERFORM 400-PRINT-DAILY-SALES
           PERFORM 600-PRINT-FOOTER
           CLOSE SALES-TRANS-MASTER
           CLOSE SALES-REPORT
           STOP RUN.
       200-PROCESS-DATA.
           ADD SALES-AMOUNT-IN TO WEEKLY-TOTAL
           EVALUATE DAY-NO-IN
                WHEN "1"
                    ADD SALES-AMOUNT-IN TO MONDAY-TOTAL
                WHEN "2"
                    ADD SALES-AMOUNT-IN TO TUESDAY-TOTAL
                WHEN "3"
                    ADD SALES-AMOUNT-IN TO WEDNESDAY-TOTAL
                WHEN "4"
                    ADD SALES-AMOUNT-IN TO THURSDAY-TOTAL
                WHEN "5"
                    ADD SALES-AMOUNT-IN TO FRIDAY-TOTAL
           END-EVALUATE.
      *PRINT THE HEADER FOR OUTPUT
       300-PRINT-HEADER.
           MOVE SPACES TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT
           MOVE PAGE-COUNT TO PAGE-NUM
           MOVE HEADER-LINE1 TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT
           MOVE HEADER-LINE2 TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT.
           ADD 1 TO PAGE-COUNT.
       400-PRINT-DAILY-SALES.
           MOVE "MON" TO WEEK-DAY-OUT
           MOVE MONDAY-TOTAL TO DAY-TOTAL-OUT
           MOVE DAILY-SALES-OUT TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT
           MOVE "TUE" TO WEEK-DAY-OUT
           MOVE TUESDAY-TOTAL TO DAY-TOTAL-OUT
           MOVE DAILY-SALES-OUT TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT
           MOVE "WED" TO WEEK-DAY-OUT
           MOVE WEDNESDAY-TOTAL TO DAY-TOTAL-OUT
           MOVE DAILY-SALES-OUT TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT
           MOVE "THU" TO WEEK-DAY-OUT
           MOVE THURSDAY-TOTAL TO DAY-TOTAL-OUT
           MOVE DAILY-SALES-OUT TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT
           MOVE "FRI" TO WEEK-DAY-OUT
           MOVE FRIDAY-TOTAL TO DAY-TOTAL-OUT
           MOVE DAILY-SALES-OUT TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT.
      *GET CURRENT DATE AND STORE TO OUTPUT RECORD
       500-GET-DATE-DATA.
           MOVE FUNCTION CURRENT-DATE TO WS-DATE
           MOVE WS-YR OF WS-DATE TO HEAD-YEAR OF DATE-OUT
           OF HEADER-LINE1
           MOVE WS-MONTH OF WS-DATE TO HEAD-MONTH OF DATE-OUT
           OF HEADER-LINE1
           MOVE WS-DAY TO HEAD-DAY OF DATE-OUT
           OF HEADER-LINE1.
       600-PRINT-FOOTER.
           MOVE WEEKLY-TOTAL TO TOTAL-WEEKLY
           MOVE FOOTER-LINE1 TO SALES-REPORT-OUT
           WRITE SALES-REPORT-OUT.


