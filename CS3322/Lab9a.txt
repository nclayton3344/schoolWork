      **************************************************************
      * THIS PROGRAM WILL READ C332200.DATA(A9IN)
      * AND POPULATE THE VSAM DATASET C332200.ASSIGNX9
      * BEFORE RUNNING THE PROGRAM,
      * SUBMIT C332200.JCL(ASSIGNA9) TO CREATE THE VSAM DATASET
      * C332200.ASSIGNX9
      * THIS JCL WILL DELETE THE EXISTING DATASET, IF THERE IS ONE
      * AND CREATE A NEW ONE
      ****************************************************************
       IDENTIFICATION DIVISION.
       PROGRAM-ID. ASSIGNA9.
       AUTHOR. NATHAN CLAYTON.
       INSTALLATION. DEPARTMENT OF ENGINEERING AND CS.
       DATE-WRITTEN. NOVEMBER 28, 2018.
       DATE-COMPILED.
       SECURITY. AUTHORIZED PERSONNEL FOR IN CLASS LEARNING ONLY.
      *
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. BUFFALO-THUNDER.
       OBJECT-COMPUTER. BUFFALO-THUNDER.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT EMPMASTS ASSIGN TO EMPMASTS.
           SELECT EMPMASTI ASSIGN TO EMPMASTI
                           ORGANIZATION IS INDEXED
                           ACCESS IS SEQUENTIAL
                           RECORD KEY IS IR-EMP-NO.
       DATA DIVISION.
       FILE SECTION.
       FD  EMPMASTS.
       01  SEQUENTIAL-RECORD-AREA      PIC X(80).
       FD  EMPMASTI.
       01  INDEXED-RECORD-AREA.
           05  IR-EMP-NO               PIC 9(3).
           05  FILLER                  PIC X(77).
       WORKING-STORAGE SECTION.
       01  SWITCHES.
           05  EMPMAST-EOF-SWITCH      PIC X    VALUE "N".
               88  EMPMAST-EOF                  VALUE "Y".
       01  EMPLOYEE-MASTER-RECORD.
           05  IM-EMP-NO              PIC 9(3).
           05  IM-EMP-NAME            PIC X(24).
           05  IM-EMP-ADDRESS         PIC X(43).
           05  FILLER                 PIC X(10) VALUE SPACE.

       PROCEDURE DIVISION.
       000-CREATE-EMPLOYEE-FILE.
           OPEN INPUT  EMPMASTS
                OUTPUT EMPMASTI.
           PERFORM 100-CREATE-EMPLOYEE-RECORD
               UNTIL EMPMAST-EOF
           CLOSE EMPMASTS
                 EMPMASTI.
           STOP RUN.

       100-CREATE-EMPLOYEE-RECORD.
           PERFORM 110-READ-SEQUENTIAL-RECORD
           IF NOT EMPMAST-EOF
               PERFORM 120-WRITE-INDEXED-RECORD.
       110-READ-SEQUENTIAL-RECORD.
           READ EMPMASTS INTO EMPLOYEE-MASTER-RECORD
               AT END
                   SET EMPMAST-EOF TO TRUE.
       120-WRITE-INDEXED-RECORD.
           WRITE INDEXED-RECORD-AREA FROM EMPLOYEE-MASTER-RECORD
               INVALID KEY
                   DISPLAY "WRITE ERROR ON EMPMAST FOR EMPLOYEE NUMBER "
                       IR-EMP-NO
                   SET EMPMAST-EOF TO TRUE
           END-WRITE
           MOVE SPACE TO EMPLOYEE-MASTER-RECORD.
